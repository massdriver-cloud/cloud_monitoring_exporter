name: Push Image
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  image_push:
    name: Push Image
    runs-on: ubuntu-latest
    env:
      MASSDRIVER_API_KEY: ${{ secrets.MASSDRIVER_API_KEY }}
      MASSDRIVER_ORG_ID: ${{ vars.MASSDRIVER_ORG_ID }}
    steps:
      - uses: actions/checkout@v3
      - name: Install Massdriver CLI
        uses: massdriver-cloud/actions/setup@v3
      - name: Push Image
        uses: massdriver-cloud/actions/image_push@a8c4c508049ac27b3409a6260c62c5d84656f2df
        with:
          namespace: 'andreas-test'
          image-name: 'miser'
          artifact: ${{ vars.MASSDRIVER_ARTIFACT_ID }}
          region: 'us-west-2'
